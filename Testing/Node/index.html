<!DOCTYPE html>
<html>
<body>

<script src="lsbtools.min.js"></script>

<script>

    function convertURIToImageData(URI) {
        return new Promise(function(resolve, reject) {
            if (URI == null) return reject();
            var canvas = document.createElement('canvas'),
                context = canvas.getContext('2d'),
                image = new Image();
            
            image.addEventListener('load', function() {
                canvas.width = image.width;
                canvas.height = image.height;
                context.drawImage(image, 0, 0, canvas.width, canvas.height);
                resolve(context.getImageData(0, 0, canvas.width, canvas.height));
            }, false);
            
            image.src = URI;
        });
    }
    
    function getDataFromImage(imageName, callback_)
    {
        var URI = imageName
        
        convertURIToImageData(URI).then(function(imageData) {
          pixels = imageData['data'];
            options = {
                shuffle: true, // spread data across image instead of writing sequentially
                matrix: true, // use matrix encoding to minimize changes
                mask: true, // mask data with stream of random bytes
                key: [1, 2, 3, 4, 5, 6, 7, 8, 9, 0], // array of bytes used as key for shuffling and masking
                pm1code: true  // use Â±1 encoding instead of LSB flip
            };
            
            a = lsbTools.read(pixels, options)
            callback_(a)
        });
    }
    
    // api we will use //
    getDataFromImage("out.png", function(data) {
        console.log(data)
    });

</script>
</body>
</html>
